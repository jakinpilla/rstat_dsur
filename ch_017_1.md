ch017\_1(탐색적인자분석)
================
jakinpilla
2020-02-23

  - [이번 장에서 배우는 내용](#이번-장에서-배우는-내용)
      - [인자분석은 언제 사용하는가?](#인자분석은-언제-사용하는가)
      - [인자](#인자)
      - [인자의 시각적 표현](#인자의-시각적-표현)
      - [인자의 수학적 표현](#인자의-수학적-표현)
      - [인자점수](#인자점수)
          - [회귀법](#회귀법)
      - [인자점수의 용도](#인자점수의-용도)
      - [인자를 찾아내는 여러 방법](#인자를-찾아내는-여러-방법)
      - [공통성](#공통성)
      - [주성분분석의 이론](#주성분분석의-이론)
      - [인자추출: 고유값과 scree plot](#인자추출-고유값과-scree-plot)
      - [해석의 개선: 인자회전](#해석의-개선-인자회전)
      - [인자 회전 방법의 선택](#인자-회전-방법의-선택)

``` r
library(ez)
library(ggplot2)
library(nlme)
library(pastecs)
library(reshape2)
library(WRS)
library(clinfun)
library(pgirmess)
library(car)
library(tidyverse)
# install.packages('mvoutlier')
library(mvoutlier)
```

### 이번 장에서 배우는 내용

인자분석

#### 인자분석은 언제 사용하는가?

latent variable: 잠재변수 /직접 측정할 수 없는 것

인자분석을 통해 (1) 일단의 변수들의 구조를 이해하는 것, (2) 바탕 변수를 측정하는 설문을 구축하는 것, (3) 주어진 자료
집합을, 원래의 정보를 최재한 유지하면서도 좀 더 다루기 쉬운 크기로 줄이는 것 등을 할 수 있다.

#### 인자

만일 변수들의 부분집합들 사이의 서로 연관된 변수들의 군집에서 비롯된 자료 집합의 군집을 형성하고 있다면, 그런 변수들이 동일한
바탕 차원의 여러 측면을 측정한 것일 가능성이 있다. 이러한 바탕 차원을 인자(factor)라고 부른다. (잠재변수라고도
한다.)

인자분석(factor analysis)은 그보다 작은 크기의 인자 집합으로 축약된다. 이를 통해서 상관 행렬에 있는 공통의 변동을
최소한의 탐색적 구인(explanatory construct)들을 이용해서 최대한 많이 설명한다는 극도의 절약이 이루어진다.

심리학의 특성론(trait theory) 연구자들은 성격의 특성을 평가할 때 인자분석을 즐겨 사용한다.

#### 인자의 시각적 표현

그래프의 분류축으로 시각화, 한 변수의 위치는 두 인자와의 상관 정도에 따라 결정된다.

같은 축에 대해 좌표성분이 큰 변수들은 어떤 공통의 바탕 측명의 서로 다른 측명을 측정한 것이라고 가정할 수 있다. 분류축에 따른
한 변수의 좌표성분을 인자적재값(factor loading)이라고 부른다.

#### 인자의 수학적 표현

인자를 서술하는 직선방정식은 선형모형을 서술하는 직선방정식과 본질적으로 같다.

인자행렬(인자분석), 성분행렬(주성분분석)

#### 인자점수

factor score

##### 회귀법

b들에 인자적재값들이 아니라 인자점수 계수들을 대입한다. 그러한 여러 인자점수 계산법은 인자점수 계수들을 대입한다는 점이 다르다.
인자 점수 계산법은 인자점수 계수를 계산하는 방법에 따라 나뉘는데, 가장 간단한 방법은 회귀법이다. 이 방법에서는 변수들의 초기
상관관계를 고려해서 인자적재값들을 수정한다. 이에 의해 측정 단위의 차이가 사라지고 변수 분산들이 안정화된다.

인자점수 계수들의 행렬(B)

상관행렬(R)

인자적재값 행렬(A)

  
![B = R^{-1}
A](https://latex.codecogs.com/png.latex?B%20%3D%20R%5E%7B-1%7D%20A
"B = R^{-1} A")  

인자적재값 행렬에 상관행렬의 역행렬을 곱한다는 것은 개념적으로 각 인자적재값을 그에 대응되는 각 상관계수로 나누는 것과 같다.
결과적인 인자점수행렬은 원래의 변수 쌍들의 관계를 고려해서 수정된 각 변수와 각 인자의 관계를 나타낸다. 그런 차원에서 이
행렬은 변수들과 인자들의 유일한 관계를 좀 더 순수하게 대표하는 측도라 할 수 있다.

#### 인자점수의 용도

  - 1)  원래의 점수들 대신 인자점수들에 대해 추가적인 분석을 수행할 수 있다.

  - 2)  회귀분석의 공선성 문제를 극복할 수 있다.

#### 인자를 찾아내는 여러 방법

목적에 따라 인자를 찾아내는 방법이 달라짐 - 첫째, 자료 표본에서 발견한 사실들을 모집단으로 일반화할 것이지… - 둘째, 특정
가설없이 자료를 탐색하는 것이 목적인지 아니면 어떤 특정한 가설을 검증하려는 것인지…

특정 기법들은 사용된 표본이 곧 모집합이며, 분석 결과를 해당 표본 이상으로는 일반화할 수는 없다고 가정한다. (주성분분석, 주축
인자분석 등)

한편, 참가자들이 무작위로 선택되었으며 측정된 변수들이 우리가 관심이 있는 변수들의 모집단을 구성한다고 가정하는 접근 방식들도
있다. 그러한 가정 하에서는 표본에서 얻은 결과를 그 보다 큰 모집단으로 일반화하는 기법이 가능하다. 그러나 모든 발견은
오직 측정된 변수들의 집합에 대해서만 참이라는 제약이 따른다.(최대가능도법, 알파 인자추출 등)

#### 공통성

특정 변수의 총 변동은 두 부분으로 구성되는데, 하나는 다른 변수(측도)들과 공유하는 부분이고, 다른 하나는 그 변수에만 해당하는
부분이다. 전자를 공통분산(common variance)이라고 부르고 후자를 유일분산(unique varianve)라고 부른다.
또한 신뢰성 있게 설명할 수 없는 분산도 있는데 이러한 분산을 임의분산(random variance)라고 부른다.

인자분석에서 우리의 관심사는 자료에 있는 공통의 바탕 차원들을 발견하는 것이므로, 기본적으로는 공통분산에만 관심을 둔다.

첫째는 분산 전체가 공통분산이라고 가정하는 것이다. 모든 변수의 공통성이 1이라고 가정한다. 이러한 가정에서 인자분석을 수행하는
것은 원래의 자료를 여러 선형 성분들로 분해하는 것에 해당한다. 이를 주성분분석이라고 한다.

둘째는 각 변수의 공통성 값을 추정함으로써 공통분산의 양을 추정하는 것이다. 공통성을 추정하는 방법은 여러가지인데, 각 변수와
다른 모든 변수의 다중상관곱을 이용하는 방법들이 있다.(알파 인자추출 등)

#### 주성분분석의 이론

주성분분석은 다변량분산분석과 비슷한 방식으로 진행된다. 우선 변수들의 관계를 나타내는 행렬을 구하고, 그 행렬의 고유값들을
계산해서 행렬의 선형 성분(변량 또는 인자)들을 구한다. 그로부터 고유벡터들을 구하는데 고유벡터의 성분들은 해당
인자의 각 변수의 인자적재값이다. 또한 고유값은 해당 고유벡터의 실질적 중요도를 나타낸다.

#### 인자추출: 고유값과 scree plot

#### 해석의 개선: 인자회전

사각회전은 바탕 인자들이 이론적으로 관련이 있을 만한 좋은 이유가 있을 때만 사용해야 한다.

인자변환행렬(factor transformation matrix)이 필요하다.

#### 인자 회전 방법의 선택

R은 직교회전을 위한 방법 네 가지와 사각회전을 위한 다섯가지 방법을 지원한다.

  - 직교회전: varimax, quartimax, BartlerT, geominT
  - 사각회전: oblimin, promax, simplimax, BentlerQ, geominQ
  - 쿼티맥스(quartimax): 한 변수의 인자적재값들이 모든 인자에 대해 최대한 넓게 퍼지는 회전각을 찾음
  - 배리맥스(varimax): 인자들 안에서의 적재값들의 분산이 최대가 되는 각도를 찾음.
  - 프로맥스(promax):프로맥스는 계산이 빠르다. 이 방법은 아주 큰 자료 집합에 맞게 설계된 것임
  - 인자들이 상관되어 있다고 가정할 이론적 근거가 있다면 직접 오블리민(direct oblimin)을 선택한다.
